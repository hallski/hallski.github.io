<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="/favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom feed"><link rel="stylesheet" href="/css/style.css" type="text/css">

		

		<link rel="stylesheet" href="/_app/assets/start-61d1577b.css">
		<link rel="stylesheet" href="/_app/assets/pages/__layout.svelte-3ab4768d.css">

		
	</head>
	<body>
		<div id="svelte">




<header><nav role="navigation" class="navbar svelte-d1vz7p"><a class="nav-link svelte-d1vz7p" href="/">Home</a>
		<ul class="svelte-d1vz7p">
			<li class="svelte-d1vz7p"><a href="/blog/" class="nav-link svelte-d1vz7p">Articles</a></li>
			
			<li class="svelte-d1vz7p"><a href="/about" class="nav-link svelte-d1vz7p">About</a></li></ul></nav>
</header>

<main class="main"><div class="content"><article class="post"><header><h1>Understanding &#39;new&#39; in JS</h1>
		<span class="post-date">September 20, 2017</span></header>
	<p>One of the things that confused me most when starting out with Javascript was <em>constructor</em> functions. That’s because when used together with <code>new</code> they look like a normal class in other langues.</p>
<div class="highlighter-rouge language-javascript"><div class="highlight"><pre class="highlight"><code><span class="hljs-keyword">const</span> instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Constructor</span>()</code></pre></div></div>
<p>However, they can also be called without the <code>new</code> keyword which will lead to <code>this</code> pointing to the global object instead. The new ES6 <code>class</code> keyword fixes that by throwing an exception when called without <code>new</code>.</p>
<p>So what does <code>new</code> do anyway?</p>
<p>After some research it seems we can simply implement our own <code>new</code> as a function like this:</p>
<div class="highlighter-rouge language-javascript"><div class="highlight"><pre class="highlight"><code><span class="hljs-keyword">function</span> <span class="hljs-title function_">myNew</span>(<span class="hljs-params">constructor, ...args</span>) {
	<span class="hljs-keyword">const</span> newObj = {}
	newObj.<span class="hljs-property">__proto__</span> = constructor.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
	<span class="hljs-keyword">const</span> fromConstructor = constructor.<span class="hljs-title function_">apply</span>(newObj, args)
	<span class="hljs-keyword">if</span> (fromConstructor) {
		<span class="hljs-keyword">return</span> fromConstructor
	}
	<span class="hljs-keyword">return</span> newObj
}</code></pre></div></div>
<p>New is simply responsible for:</p>
<ol><li>Creating a new object</li>
<li>Set it’s prototype to that of the constructors <code>prototype</code> property</li>
<li>Call the constructor with <code>this</code> bound to the newly created object.</li>
<li>As constructors in Javascript are allowed to return a different object, <code>new</code> also needs to check if it did and return that instead when that’s the case.</li></ol></article></div></main>

<footer class="site-footer svelte-1h9y0mo"><div class="author svelte-1h9y0mo"><img class="author-photo svelte-1h9y0mo" src="/images/hallski.jpg" width="192" height="192" alt="Author">
		<div><p class="author-name svelte-1h9y0mo">Mikael Hallendal</p>
			<p class="author-info svelte-1h9y0mo">Developer who loves to learn new things.</p>
			<p class="author-interests svelte-1h9y0mo">Current focus: <span class="interest svelte-1h9y0mo">React</span>,
				<span class="interest svelte-1h9y0mo">Javascript/Typescript</span> and
				<span class="interest svelte-1h9y0mo">Elixir</span></p>
			<nav class="find-me svelte-1h9y0mo"><a href="http://github.com/hallski/" class="svelte-1h9y0mo">Github</a>
				<a href="http://twitter.com/mhallendal/" class="svelte-1h9y0mo">Twitter</a>
				<a href="http://www.linkedin.com/in/mhallendal" class="svelte-1h9y0mo">LinkedIn</a></nav></div></div>
</footer>



			
		</div>
	</body>
</html>
