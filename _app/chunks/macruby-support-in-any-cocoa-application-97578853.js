import{S as U,i as ss,s as es,w as Y,f as as,m as ts,j as ls,k as K,q as os,n as ns,o as is,P as Q,e as l,g as i,a as Z,b as a,d as t}from"./vendor-952ab843.js";import{B as ps}from"./blog-layout-d30acb2f.js";function rs(f){let o,r,c,u,n,p,m,I,b,R,h,q,w,$,j,B,_,W,v,A,k,E,d,F,M,N,y,O,C,P,x,z,g,D,T,G,L,V,H,X,S;return{c(){o=l("p"),o.innerHTML='Yesterday I published a post about <a href="/blog/cocoa-prototyping-with-webview">Cocoa Prototyping with Webview</a> and today I found out about <a href="http://www.macruby.org/" rel="nofollow">Macruby</a> thanks to <a href="http://twitter.com/sarnesjo" rel="nofollow">@sarnesjo</a>. Already looking for ways of prototyping in Cocoa it\u2019s hard to not find Macruby very interesting.',r=i(),c=l("p"),c.textContent="Macruby turns out to be a very powerful tool for prototyping (as well as writing entire applications in) as it fits perfectly fine in a normal Objective-C code base. What I wanted was something like this:",u=i(),n=l("div"),n.innerHTML=`<div class="highlight"><pre class="highlight"><code><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SimpleController</span></span>
    <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:label</span>
    <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:button</span>
    <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:my_view</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">buttonPressed</span><span class="hljs-params">(sender)</span></span>
        label.setStringValue(<span class="hljs-string">&quot;I am (im)pressed!&quot;</span>)
        my_view.backgroundColor = NSColor.redColor
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span></code></pre></div>`,p=i(),m=l("p"),m.innerHTML="Where the view <code>:my_view</code> is implemented in Objective-C.",I=i(),b=l("p"),b.textContent="Here are the simple steps I used to hook it into a normal Xcode Cocoa project.",R=i(),h=l("p"),h.textContent="First of all, install Macruby which is as easy as downloading the zip-file from the website and run the installer.",q=i(),w=l("p"),w.textContent="In order to link to the Macruby framework you need to use garbage collection in your project, if you aren\u2019t already you enable it in the project inspector:",$=i(),j=l("p"),j.innerHTML='<img src="/images/posts/macruby-in-xcode-gc.png" alt="Set the project to use Garbage Collection"/>',B=i(),_=l("p"),_.textContent="Next you need to make your project link against the Macruby framework:",W=i(),v=l("p"),v.innerHTML='<img src="/images/posts/macruby-in-xcode-add-framework.png" alt="Add the Macruby framework"/>',A=i(),k=l("p"),k.innerHTML="That\u2019s it for the project settings, let\u2019s hook it up in the code. When you use the built-in project template for a Macruby project a small Ruby file called <em>rb_main.rb</em> is created for you. Since I\u2019m using a generic Cocoa application template I needed to create this file and simply copied the file into my new project (its code below). It loads all Ruby files in your bundle and starts the Cocoa main loop.",E=i(),d=l("div"),d.innerHTML=`<div class="highlight"><pre class="highlight"><code><span class="hljs-comment"># Loading the Cocoa framework. If you need to load more frameworks, you can</span>
<span class="hljs-comment"># do that here too.</span>
framework <span class="hljs-string">&#39;Cocoa&#39;</span>

<span class="hljs-comment"># Loading all the Ruby project files.</span>
dir_path = NSBundle.mainBundle.resourcePath.fileSystemRepresentation
Dir.entries(dir_path).each <span class="hljs-keyword">do</span> <span class="hljs-params">|path|</span>
  <span class="hljs-keyword">if</span> path != File.basename(<span class="hljs-keyword">__FILE__</span>) <span class="hljs-keyword">and</span> path[-<span class="hljs-number">3</span>..-<span class="hljs-number">1</span>] == <span class="hljs-string">&#39;.rb&#39;</span>
    <span class="hljs-keyword">require</span>(path)
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-comment"># Starting the Cocoa main loop.</span>
NSApplicationMain(<span class="hljs-number">0</span>, <span class="hljs-literal">nil</span>)</code></pre></div>`,F=i(),M=l("p"),M.innerHTML="To start the actual Ruby interpreter the file <em>main.m</em> needs to be modified. Since the Ruby code now starts the Cocoa main loop we no longer need to do that in <code>main</code>. <em>Main.m</em> simply becomes:",N=i(),y=l("div"),y.innerHTML=`<div class="highlight"><pre class="highlight"><code><span class="hljs-meta">#import <span class="hljs-string">&lt;MacRuby/MacRuby.h&gt;</span></span>

<span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span>
{
    <span class="hljs-keyword">return</span> macruby_main(<span class="hljs-string">&quot;rb_main.rb&quot;</span>, argc, argv);
}</code></pre></div>`,O=i(),C=l("p"),C.textContent="With these changes you can now start writing code in either Ruby or Objective-C within the same project. Here are the files I ended up with in my very small example.",P=i(),x=l("p"),x.innerHTML='<img src="/images/posts/macruby-in-xcode-files.png" alt="Example Files"/>',z=i(),g=l("p"),g.textContent="The final application simply shows a small window with a button:",D=i(),T=l("p"),T.innerHTML='<img src="/images/posts/macruby-in-xcode-example.png" alt="Example window"/>',G=i(),L=l("p"),L.innerHTML='Make sure to watch the great <a href="http://pragmaticstudio.com/screencasts/6-macruby" rel="nofollow">introductionary screencast</a> then download the example project and get started tinkering.',V=i(),H=l("p"),H.textContent="If you find this as cool and useful as I did, let me hear about it!",X=i(),S=l("p"),S.innerHTML="<strong>Edit:</strong> Be sure to read Laurents comment below for an alternative way of loading your Ruby files into your application.",Z(n,"class","highlighter-rouge language-ruby"),Z(d,"class","highlighter-rouge language-ruby"),Z(y,"class","highlighter-rouge language-c")},m(s,e){a(s,o,e),a(s,r,e),a(s,c,e),a(s,u,e),a(s,n,e),a(s,p,e),a(s,m,e),a(s,I,e),a(s,b,e),a(s,R,e),a(s,h,e),a(s,q,e),a(s,w,e),a(s,$,e),a(s,j,e),a(s,B,e),a(s,_,e),a(s,W,e),a(s,v,e),a(s,A,e),a(s,k,e),a(s,E,e),a(s,d,e),a(s,F,e),a(s,M,e),a(s,N,e),a(s,y,e),a(s,O,e),a(s,C,e),a(s,P,e),a(s,x,e),a(s,z,e),a(s,g,e),a(s,D,e),a(s,T,e),a(s,G,e),a(s,L,e),a(s,V,e),a(s,H,e),a(s,X,e),a(s,S,e)},d(s){s&&t(o),s&&t(r),s&&t(c),s&&t(u),s&&t(n),s&&t(p),s&&t(m),s&&t(I),s&&t(b),s&&t(R),s&&t(h),s&&t(q),s&&t(w),s&&t($),s&&t(j),s&&t(B),s&&t(_),s&&t(W),s&&t(v),s&&t(A),s&&t(k),s&&t(E),s&&t(d),s&&t(F),s&&t(M),s&&t(N),s&&t(y),s&&t(O),s&&t(C),s&&t(P),s&&t(x),s&&t(z),s&&t(g),s&&t(D),s&&t(T),s&&t(G),s&&t(L),s&&t(V),s&&t(H),s&&t(X),s&&t(S)}}}function cs(f){let o,r;const c=[f[0],J];let u={$$slots:{default:[rs]},$$scope:{ctx:f}};for(let n=0;n<c.length;n+=1)u=Y(u,c[n]);return o=new ps({props:u}),{c(){as(o.$$.fragment)},m(n,p){ts(o,n,p),r=!0},p(n,[p]){const m=p&1?ls(c,[p&1&&K(n[0]),p&0&&K(J)]):{};p&2&&(m.$$scope={dirty:p,ctx:n}),o.$set(m)},i(n){r||(os(o.$$.fragment,n),r=!0)},o(n){ns(o.$$.fragment,n),r=!1},d(n){is(o,n)}}}const J={comments:!1,date:"2009-05-06T00:00:00Z",section:"blog",tags:["ruby"],title:"Macruby Support in any Cocoa Application"};function us(f,o,r){return f.$$set=c=>{r(0,o=Y(Y({},o),Q(c)))},o=Q(o),[o]}class ms extends U{constructor(o){super();ss(this,o,us,cs,es,{})}}var ys=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ms,metadata:J});export{ms as M,ys as _,J as m};
