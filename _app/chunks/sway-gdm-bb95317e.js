import{S as I,i as q,s as D,y as $,r as O,u as F,v as K,w as C,m as N,k as z,x as B,I as G,e as a,g as r,a as L,c as t,n as P,f as l}from"./index-0d9ad2d2.js";import{B as W}from"./blog-layout-f66b7ab1.js";function R(m){let o,p,d,u,n,i,f,S,y,k,w,x,c,M,g,T,h,j,v,H,_,E,b;return{c(){o=a("h2"),o.textContent="Running Sway on Fedora 31 with GDM",p=r(),d=a("p"),d.innerHTML='After upgrading to Fedora 31 a crucial extension <a href="https://github.com/timbertson/slinger" rel="nofollow">Slinger</a>, stopped working. Luckily the <a href="https://swaywm.org/" rel="nofollow">Sway</a> package had been updated to 1.1 so figured I\u2019d try it out.',u=r(),n=a("p"),n.innerHTML="In summary it\u2019s been working really well however in order to use the GNOME Keyring Daemon as SSH Agent I needed to pass an environment variable to the Sway process. Turns out something changed in how Wayland sessions (compared to X) were started and the old <code>~/.profile</code> solution didn\u2019t work any longer.",i=r(),f=a("p"),f.textContent="After some Googling I found out that the gnome-shell came with a workaround for this where it runs a custom script before actually starting the shell.",S=r(),y=a("p"),y.textContent="Copying that setup here is what I did in order to get it to work.",k=r(),w=a("p"),w.innerHTML="Make a copy of <code>sway.desktop</code> in <code>/usr/share/wayland-sessions</code> to <code>sway-shell.desktop</code> and make sure it has the same mods.",x=r(),c=a("div"),c.innerHTML=`<div class="highlight"><pre class="highlight"><code>[Desktop Entry]
Name=Sway Shell
Comment=An i3-compatible Wayland compositor
Exec=/usr/bin/sway-shell
TryExec=/usr/bin/sway-shell
Type=Application</code></pre></div>`,M=r(),g=a("p"),g.innerHTML="Copy <code>/usr/bin/gnome-session</code> to <code>/usr/bin/sway-shell</code> and replace the last like with",T=r(),h=a("div"),h.innerHTML='<div class="highlight"><pre class="highlight"><code><span class="hljs-built_in">exec</span> /usr/bin/sway <span class="hljs-string">&quot;<span class="hljs-variable">$@</span>&quot;</span></code></pre></div>',j=r(),v=a("p"),v.innerHTML="Edit <code>~/.profile</code> (or in my case <code>~/.zprofile</code>) to setup the environment.",H=r(),_=a("div"),_.innerHTML=`<div class="highlight"><pre class="highlight"><code><span class="hljs-keyword">if</span> [ -n <span class="hljs-string">&quot;<span class="hljs-variable">$DESKTOP_SESSION</span>&quot;</span> ];<span class="hljs-keyword">then</span>
  <span class="hljs-built_in">eval</span> $(gnome-keyring-daemon --start --components=ssh)
  <span class="hljs-built_in">export</span> SSH_AUTH_SOCK
  <span class="hljs-built_in">export</span> GTK_THEME=<span class="hljs-string">&quot;Adwaita-dark&quot;</span>
<span class="hljs-keyword">fi</span></code></pre></div>`,E=r(),b=a("p"),b.innerHTML="After that I simply logged out, changed to use <strong>Sway Shell</strong> in GDM and logged back in.",L(c,"class","highlighter-rouge language-text"),L(h,"class","highlighter-rouge language-bash"),L(_,"class","highlighter-rouge language-bash")},m(e,s){t(e,o,s),t(e,p,s),t(e,d,s),t(e,u,s),t(e,n,s),t(e,i,s),t(e,f,s),t(e,S,s),t(e,y,s),t(e,k,s),t(e,w,s),t(e,x,s),t(e,c,s),t(e,M,s),t(e,g,s),t(e,T,s),t(e,h,s),t(e,j,s),t(e,v,s),t(e,H,s),t(e,_,s),t(e,E,s),t(e,b,s)},p:P,d(e){e&&l(o),e&&l(p),e&&l(d),e&&l(u),e&&l(n),e&&l(i),e&&l(f),e&&l(S),e&&l(y),e&&l(k),e&&l(w),e&&l(x),e&&l(c),e&&l(M),e&&l(g),e&&l(T),e&&l(h),e&&l(j),e&&l(v),e&&l(H),e&&l(_),e&&l(E),e&&l(b)}}}function U(m){let o,p;const d=[m[0],A];let u={$$slots:{default:[R]},$$scope:{ctx:m}};for(let n=0;n<d.length;n+=1)u=$(u,d[n]);return o=new W({props:u}),{c(){O(o.$$.fragment)},m(n,i){F(o,n,i),p=!0},p(n,[i]){const f=i&1?K(d,[i&1&&C(n[0]),i&0&&C(A)]):{};i&2&&(f.$$scope={dirty:i,ctx:n}),o.$set(f)},i(n){p||(N(o.$$.fragment,n),p=!0)},o(n){z(o.$$.fragment,n),p=!1},d(n){B(o,n)}}}const A={date:"2019-11-04T00:00:00Z",excerpt:"Setting up Sway to work on Fedora 31 with GDM as desktop manager and gnome-keyring-daemon.",section:"blog",tags:["linux","sway","wayland","GNOME"],title:"Sway on Fedora 31 with GDM"};function X(m,o,p){return m.$$set=d=>{p(0,o=$($({},o),G(d)))},o=G(o),[o]}class Z extends I{constructor(o){super(),q(this,o,X,U,D,{})}}var V=Object.freeze(Object.defineProperty({__proto__:null,default:Z,metadata:A},Symbol.toStringTag,{value:"Module"}));export{Z as S,V as _,A as m};
